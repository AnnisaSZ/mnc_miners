<odoo>

    <record id="list_report_head_view_tree" model="ir.ui.view">
        <field name="name">List Reports</field>
        <field name="model">wbs.report.head</field>
        <field name="arch" type="xml">
            <tree duplicate="0" decoration-success="state in ('close')" decoration-warning="state in ('process_audit','report_audit','result_audit')">
                <field name="name"/>
                <field name="title"/>
                <field name="company_id"/>
                <field name="start_date"/>
                <field name="end_date"/>
                <field name="director_id" string="Director's Name"/>
                <field name="head_auditor_id"/>
                <field name="state"  readonly="1" widget="badge"/>
            </tree>
        </field>
    </record>
    
    <record id="list_report_head_view_form" model="ir.ui.view">
        <field name="name">List Report Form</field>
        <field name="model">wbs.report.head</field>
        <field name="arch" type="xml">
            <form  flags="{'mode': 'edit'}">
                <header>
                    <field name="is_dir" invisible="1"/>
                    <field name="is_summary" invisible="1"/>
                    <field name="is_not_auditor" invisible="1"/>
                    
                    <button name="assign_to_employee" string="Process to Audit" type="object" class="oe_highlight" attrs="{'invisible': [('state', 'not in', ('assigned', 'process_audit'))]}"/>
                    <button name="result_to_director" string="Send Report" type="object" class="oe_highlight" attrs="{'invisible': ['|', ('state', 'not in', ['process_audit', 'report_audit', 'result_audit']), ('is_summary', '=', True)]}"/>
                    
                    <field name="state" readonly="True" widget="statusbar" options="{'clickable': '0'}" statusbar_visible="process_audit,result_audit,close" force_save="1"/>
                </header>
                <sheet>
                    <label for="name"/>
                    <h1>
                        <field name="name" readonly="1"/>
                    </h1>

                    <!-- Case Report From User -->
                    <h3> Case Reported </h3>
                    <group>
                        <group>
                            <field name="title"/>
                            <field name="company_id"/>
                        </group>
                        <group>
                            <label for="start_date" string="Period of Incident"/>
                            <div>
                                <field name="start_date" class="oe_inline"/>
                                <i class="fa fa-long-arrow-right mx-2" aria-label="Arrow icon" title="Arrow"/> 
                                <field name="end_date" class="oe_inline"/>
                            </div>
                            <field name="casedescription" readonly="True"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Attachment" name="attchment">
                            <field name="attachment_ids" options="{'no_open': True}" readonly="1">
                                <tree editable="bottom" options="{'no_create': True, 'no_create_edit': True, 'no_open': True}">
                                    <field name="name" readonly="1"/>
                                    <field name="datas" widget="binary" string="Download"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>


                    <!-- Director -->
                    <h3> Director Review </h3>
                    <group>
                        <group>
                            <field name="director_id"/>
                            <field name="dir_notes" style="white-space: pre-wrap; word-break: break-all;" attrs="{'readonly': [('is_dir', '=', False)]}"/>
                        </group>
                    </group>
                    <group>
                        <field name="dir_attachment_ids" attrs="{'readonly': [('is_dir', '=', False)]}" string="Director Attach.">
                            <tree editable="bottom">
                                <field name="part_filename" string="Name" readonly="1" force_save="1"/>
                                <field name="part_dokumen" string="Download" widget="binary"/>
                            </tree>
                        </field>
                    </group>

                    <!-- Head Audit (if assign from head audit) -->
                    <h3> Result </h3>
                    <group>
                        <group>
                            <field name="head_auditor_id" attrs="{'invisible': [('is_not_auditor', '=', True)]}" readonly="True"/>
                            <field name="employee_id" string="Full Name" attrs="{'invisible': [('is_not_auditor', '=', False)]}" readonly="True"/>
                            <!-- Result -->
                            <field string="My Notes" name="head_auditor_notes" attrs="{'required': [('report_as', '=', 'own')]}"/>
                            <field string="My Notes" name="summary_audit" invisible="1"/>
                        </group>
                        <group>
                            <label for="start_date_audit" string="Period of Audit"/>
                            <div>
                                <field name="start_date_audit" class="oe_inline" readonly="1"/>
                                <i class="fa fa-long-arrow-right mx-2" aria-label="Arrow icon" title="Arrow"/> 
                                <field name="end_date_audit" class="oe_inline" readonly="1"/>
                            </div>
                            <field name="report_as" widget="radio" options="{'horizontal': true}" attrs="{'invisible': [('is_not_auditor', '=', True)]}"/>
                            <field name="member_ids" string="Member" invisible="1" widget="many2many_tags"/>
                        </group>
                    </group>
                    <group>
                        <field name="head_attachment_ids" string="Document.">
                            <tree editable="bottom">
                                <field name="part_filename" string="Name" readonly="1" force_save="1"/>
                                <field name="part_dokumen" string="Download" filename="part_filename" widget="binary"/>
                            </tree>
                        </field>
                    </group>

                    <!-- Assign to Auditor -->
                    <h3 attrs="{'invisible': [('report_as', '=', 'own')]}">Assign to Auditor</h3>
                    <group attrs="{'invisible': [('report_as', '=', 'own')]}">
                        <field name="list_emp_report_ids" context="{'default_member_ids':member_ids,'default_head_auditor_id':head_auditor_id, 'default_list_head_report_id': id, 'default_is_head':True}">
                            <tree decoration-success="state in ('close')" decoration-warning="state in ('report_audit','result_audit')">
                                <field name="list_head_report_id" invisible="0"/>
                                <field name="member_ids" widget="many2many_tags" invisible="1"/>
                                <field name="employee_id" string="Auditor" readonly="False" domain="[('id','in',parent.member_ids)]"/>
                                <field name="state" string="Status" readonly="1"/>
                            </tree>
                            <form edit="1" flags="{'mode': 'edit'}">
                                <header>
                                    <field name="is_head" invisible="1"/>
                                    <field name="is_dir" invisible="1"/>
                                    <field name="from_head" invisible="1"/>
                                    <field name="list_head_report_id" invisible="1"/>

                                    <button name="button_revise_audit" string="Revise" type="object" class="oe_highlight" attrs="{'invisible': [('state', '!=', 'report_audit')]}"/>
                                    <field name="state" readonly="True" widget="statusbar" options="{'clickable': '0'}" statusbar_visible="process_audit,result_audit,close"/>
                                </header>
                                <sheet>
                                    <h3> Head Auditor Review </h3>
                                    <group>
                                        <group>
                                            <field name="head_auditor_id" readonly="True"/>
                                            <field name="head_auditor_notes" attrs="{'required': [('is_head', '=', True)], 'readonly':[('state', '=', 'close')]}"/>
                                        </group>
                                        <group>
                                            <field name="employee_id" attrs="{'required': ['|',('state', '!=', 'assigned'),('is_head', '=', True)]}" domain="[('id','in',parent.member_ids)]" readonly="0"/>
                                        </group>
                                    </group>
                                    <group>
                                        <field name="head_auditor_attachment_ids" string="Head Auditor Attach." attrs="{'readonly': [('state', 'not in', ('assigned', 'process_audit'))]}">
                                            <tree editable="bottom">
                                                <field name="part_filename" string="Name" readonly="1" force_save="1"/>
                                                <field name="part_dokumen" string="Download" filename="part_filename" widget="binary"/>
                                            </tree>
                                        </field>
                                    </group>

                                    <!-- Employee -->
                                    <h3>Employee/Auditor</h3>
                                    <group>
                                        <field name="is_employee" invisible="1"/>
                                        <field name="result_auditor_emp" readonly="1"/>
                                    </group>
                                    <group>
                                        <field name="emp_attachment_ids" options="{'no_open': True}" string="Employee Attach." readonly="1">
                                            <tree editable="bottom" >
                                                <field name="part_filename" string="Name" readonly="1" force_save="1"/>
                                                <field name="part_dokumen" string="Download" filename="part_filename" widget="binary"/>
                                            </tree>
                                        </field>
                                    </group>
                                </sheet>
                            </form>
                        </field>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <record id="list_report_head_result" model="ir.ui.view">
        <field name="name">List Report Form</field>
        <field name="model">wbs.report.head</field>
        <field name="arch" type="xml">
            <form>
                <field name="report_as" widget='radio' options="{'horizontal': true}" invisible="1"/>
                <field name="member_ids" widget='radio' options="{'horizontal': true}" invisible="1"/>
                <header>
                    <field name="is_dir" invisible="1"/>
                    <field name="is_summary" invisible="1"/>
                    <field name="is_not_auditor" invisible="1"/>
                    <button name="director_closing" string="Close" type="object" class="oe_highlight" attrs="{'invisible': ['|', ('state', '!=', 'result_audit'), ('is_dir', '=', False)]}"/>
                    <button name="button_revise_head_audit" string="Revise" type="object" attrs="{'invisible': [('state', '!=', 'result_audit')]}"/>
                    <field name="state" readonly="True" widget="statusbar" invisible="0" statusbar_visible="report_audit,result_audit,close"/>
                </header>
                <sheet>
                    <h3 attrs="{'readonly': [('state', '!=', 'result_audit')]}"> Summary by <field name="employee_id" readonly="True"/> </h3>
                    <field name="summary_audit" attrs="{'invisible': [('state', 'not in', ('result_audit','close'))]}" type="html" nolabel="1"/>
                    
                    <div class="d-none oe_clear"/>
                    <!--  -->
                    <h3 attrs="{'readonly': [('state', '!=', 'result_audit'), ('report_as', '!=', 'own')]}"> Document </h3>
                    <field name="head_attachment_ids" string="My Document.">
                        <tree editable="bottom" >
                            <field name="part_filename" string="Name" readonly="1" force_save="1"/>
                            <field name="part_dokumen" string="Download" filename="part_filename" widget="binary"/>
                        </tree>
                    </field>
                </sheet>
            </form>
        </field>
    </record>

    <record id="report_head_summary_form_view" model="ir.ui.view">
        <field name="name">Summary Audit</field>
        <field name="model">wbs.report.head</field>
        <field name="arch" type="xml">
            <form>                
                <group string="Notes">
                    <!-- <field name="wbs_head_id" invisible="1"/> -->
                </group>
                <field name="head_auditor_notes" nolabel="1"/>

                <group string="Attachment"/>
                <field name="head_attachment_ids">
                    <tree editable="bottom">
                        <field name="part_filename" string="Name" readonly="1" force_save="1"/>
                        <field name="part_dokumen" string="Download" widget="binary" filename="part_filename"/>
                    </tree>
                </field>
                
                <div class="d-none oe_clear"/>
                <footer>
                    <button
                        name="action_submit"
                        string="Submit"
                        type="object"
                        default_focus="1"
                        class="oe_highlight"
                    />
                    <button string="Cancel" class="oe_link" special="cancel" />
                </footer>
            </form>
        </field>
    </record>

    <record id="list_report_head_view" model="ir.actions.act_window">
        <field name="name">List Reports</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">wbs.report.head</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('user_head_employee_id', '=', uid)]</field>
        <field name="context">{'delete': 1, 'duplicate': 0, 'create':0, 'form_view_initial_mode': 'edit'}</field>
        <field name="help" type="html">
            <p>
                Add New List Report
            </p>
        </field>
    </record>

    <record id="list_report_overview" model="ir.actions.act_window">
        <field name="name">Reporting</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">wbs.report.head</field>
        <field name="view_mode">tree,form</field>
        <field name="context">{'edit': 0,'delete': 0, 'duplicate': 0, 'create':0}</field>
        <field name="view_ids" eval="[(5, 0, 0),
                (0, 0, {'view_mode': 'tree', 'view_id': ref('list_report_head_view_tree')}),
                (0, 0, {'view_mode': 'form', 'view_id': ref('list_report_head_result')})]"/>
        <field name="help" type="html">
            <p>
                Add New List Report
            </p>
        </field>
    </record>

    <record id="list_report_summary" model="ir.actions.act_window">
        <field name="name">Sumarry Reporting</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">wbs.report.head</field>
        <field name="view_mode">form</field>
        <field name="context">{'edit': 0,'delete': 0, 'duplicate': 0, 'create':0}</field>
        <field name="view_ids" eval="[(5, 0, 0),
                (0, 0, {'view_mode': 'form', 'view_id': ref('report_head_summary_form_view')})]"/>
        <field name="help" type="html">
            <p>
                Add New List Report
            </p>
        </field>
    </record>
</odoo>
